/app/alekfi/workers/market_context_worker.py:351: RuntimeWarning: invalid value encountered in scalar divide
{"ts": "2026-02-16T14:55:00.515658+00:00", "level": "INFO", "logger": "alekfi.workers.signal_decay_worker", "msg": "[HEARTBEAT] signal_decay_worker cycle=1 done: processed=0 elapsed=4.2s total_processed=0 total_outcomes=0 total_errors=0"}
{"ts": "2026-02-16T14:55:02.283954+00:00", "level": "INFO", "logger": "alekfi.brain.brain_pipeline", "msg": "[pipeline:S4] direction balance warning: 88% LONG"}
{"ts": "2026-02-16T14:55:06.737153+00:00", "level": "WARNING", "logger": "alekfi.workers.options_flow_worker", "msg": "[options-worker] rate limited on AMZN, backing off"}
{"ts": "2026-02-16T14:55:11.912354+00:00", "level": "WARNING", "logger": "alekfi.workers.options_flow_worker", "msg": "[options-worker] rate limited on BABA, backing off"}
{"ts": "2026-02-16T14:57:02.601487+00:00", "level": "INFO", "logger": "alekfi.brain.brain_pipeline", "msg": "[pipeline:S4] direction balance warning: 88% LONG"}
{"ts": "2026-02-16T14:57:40.069145+00:00", "level": "WARNING", "logger": "alekfi.brain.outcome_attribution", "msg": "[attribution] Could not load source_credibility; using defaults"}
{"ts": "2026-02-16T14:57:56.063358+00:00", "level": "WARNING", "logger": "alekfi.brain.brain_pipeline", "msg": "[pipeline:S5] traceability insert FAILED for ZIM", "exception": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 550, in _prepare_and_execute\n    self._rows = deque(await prepared_stmt.fetch(*parameters))\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 177, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 268, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 257, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 205, in bind_execute\nasyncpg.exceptions.ForeignKeyViolationError: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(7fa336a5-73d0-4178-acb9-0bb121d20ee6) is not present in table \"raw_posts\".\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2125, in _exec_insertmany_context\n    dialect.do_execute(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 952, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 585, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 563, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 513, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 797, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.ForeignKeyViolationError'>: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(7fa336a5-73d0-4178-acb9-0bb121d20ee6) is not present in table \"raw_posts\".\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/alekfi/brain/brain_pipeline.py\", line 1642, in _stage5_risk_adjust\n    async with get_session() as trace_session:\n               ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/contextlib.py\", line 217, in __aexit__\n    await anext(self.gen)\n  File \"/app/alekfi/db/database.py\", line 64, in get_session\n    await session.commit()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py\", line 1000, in commit\n    await greenlet_spawn(self.sync_session.commit)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2030, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 1311, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 1286, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4331, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4466, in _flush\n    with util.safe_reraise():\n         ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4427, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py\", line 1143, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1419, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 527, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2133, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2363, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2125, in _exec_insertmany_context\n    dialect.do_execute(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 952, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 585, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 563, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 513, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 797, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.ForeignKeyViolationError'>: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(7fa336a5-73d0-4178-acb9-0bb121d20ee6) is not present in table \"raw_posts\".\n[SQL: INSERT INTO signal_source_items (id, signal_id, raw_post_id, contribution_weight, platform, created_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::VARCHAR, $6::TIMESTAMP WITH TIME ZONE), ($7::UUID, $8::UUID, $9::UUID, $10::FLOAT, $11::VARCH ... 578 characters truncated ... ME ZONE), ($49::UUID, $50::UUID, $51::UUID, $52::FLOAT, $53::VARCHAR, $54::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID('91c15599-4388-46a0-914e-1c0e08e241b8'), UUID('7408e7f9-3b51-4d38-b055-cb229366a84a'), UUID('7fa336a5-73d0-4178-acb9-0bb121d20ee6'), 0.1111111111111111, 'unknown', datetime.datetime(2026, 2, 16, 14, 57, 56, 57933, tzinfo=datetime.timezone.utc), UUID('70f3edb2-bef2-4b35-99f1-9c041335317c'), UUID('7408e7f9-3b51-4d38-b055-cb229366a84a'), UUID('0c4f8f6d-e6cf-4a29-ad43-207c155f488d'), 0.1111111111111111, 'unknown', datetime.datetime(2026, 2, 16, 14, 57, 56, 57942, tzinfo=datetime.timezone.utc), UUID('96fedb24-794f-4174-b8ba-a10c98eea178'), UUID('7408e7f9-3b51-4d38-b055-cb229366a84a'), UUID('97b20199-09b9-4816-8c57-8981a40dd9b9'), 0.1111111111111111, 'unknown', datetime.datetime(2026, 2, 16, 14, 57, 56, 57945, tzinfo=datetime.timezone.utc), UUID('8f35b50d-ea43-4db0-a781-e51a4ccf360e'), UUID('7408e7f9-3b51-4d38-b055-cb229366a84a'), UUID('2f96f970-64ff-4655-ba76-63773922705c'), 0.1111111111111111, 'unknown', datetime.datetime(2026, 2, 16, 14, 57, 56, 57950, tzinfo=datetime.timezone.utc), UUID('07539774-444a-4853-bcbd-76d2d2dfa0b8'), UUID('7408e7f9-3b51-4d38-b055-cb229366a84a'), UUID('cf7b5804-5568-4b16-89ce-01b9bb1a2464'), 0.1111111111111111, 'unknown', datetime.datetime(2026, 2, 16, 14, 57, 56, 57953, tzinfo=datetime.timezone.utc), UUID('b077b809-b3cc-4d4e-8b3c-fa356391c515'), UUID('7408e7f9-3b51-4d38-b055-cb229366a84a'), UUID('53f19729-f52a-494f-b391-2e43114dc381'), 0.1111111111111111, 'unknown', datetime.datetime(2026, 2, 16, 14, 57, 56, 57958, tzinfo=datetime.timezone.utc), UUID('1b679b43-2295-441d-9c2f-c447f569c4d5'), UUID('7408e7f9-3b51-4d38-b055-cb229366a84a'), UUID('2291ae96-7230-424f-9cca-49c7a562137d'), 0.1111111111111111, 'unknown', datetime.datetime(2026, 2, 16, 14, 57, 56, 57961, tzinfo=datetime.timezone.utc), UUID('3bab095d-6647-4fae-ac4d-3ec9a22c6e9b'), UUID('7408e7f9-3b51-4d38-b055-cb229366a84a'), UUID('3b52929e-3382-4646-93bc-80ad58d7bef6'), 0.1111111111111111, 'unknown', datetime.datetime(2026, 2, 16, 14, 57, 56, 57964, tzinfo=datetime.timezone.utc), UUID('5c5d3a5b-8368-4321-93b1-d94096d8303d'), UUID('7408e7f9-3b51-4d38-b055-cb229366a84a'), UUID('2d7dd5f4-50fe-4457-8c85-64de11229284'), 0.1111111111111111, 'unknown', datetime.datetime(2026, 2, 16, 14, 57, 56, 57967, tzinfo=datetime.timezone.utc))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2026-02-16T15:02:12.214404+00:00", "level": "WARNING", "logger": "alekfi.brain.brain_pipeline", "msg": "[pipeline:S5] traceability insert FAILED for HLAG.DE", "exception": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 550, in _prepare_and_execute\n    self._rows = deque(await prepared_stmt.fetch(*parameters))\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 177, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 268, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 257, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 205, in bind_execute\nasyncpg.exceptions.ForeignKeyViolationError: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(76892afb-896a-4e61-8bb4-eb546735e3a1) is not present in table \"raw_posts\".\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2125, in _exec_insertmany_context\n    dialect.do_execute(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 952, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 585, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 563, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 513, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 797, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.ForeignKeyViolationError'>: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(76892afb-896a-4e61-8bb4-eb546735e3a1) is not present in table \"raw_posts\".\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/alekfi/brain/brain_pipeline.py\", line 1642, in _stage5_risk_adjust\n    async with get_session() as trace_session:\n               ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/contextlib.py\", line 217, in __aexit__\n    await anext(self.gen)\n  File \"/app/alekfi/db/database.py\", line 64, in get_session\n    await session.commit()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py\", line 1000, in commit\n    await greenlet_spawn(self.sync_session.commit)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2030, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 1311, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 1286, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4331, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4466, in _flush\n    with util.safe_reraise():\n         ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4427, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py\", line 1143, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1419, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 527, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2133, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2363, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2125, in _exec_insertmany_context\n    dialect.do_execute(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 952, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 585, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 563, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 513, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 797, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.ForeignKeyViolationError'>: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(76892afb-896a-4e61-8bb4-eb546735e3a1) is not present in table \"raw_posts\".\n[SQL: INSERT INTO signal_source_items (id, signal_id, raw_post_id, contribution_weight, platform, created_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::VARCHAR, $6::TIMESTAMP WITH TIME ZONE), ($7::UUID, $8::UUID, $9::UUID, $10::FLOAT, $11::VARCH ... 854 characters truncated ... ME ZONE), ($67::UUID, $68::UUID, $69::UUID, $70::FLOAT, $71::VARCHAR, $72::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID('4e110a3e-3573-41f1-bf7d-a3d528a3573a'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('76892afb-896a-4e61-8bb4-eb546735e3a1'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210734, tzinfo=datetime.timezone.utc), UUID('c20c92a1-8dc7-4b29-9792-244ecea24855'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('bbeff2fb-0a57-4160-82b8-18c531bc1a07'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210741, tzinfo=datetime.timezone.utc), UUID('25e99414-0d6e-4211-b1fc-d4765b25f083'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('a552da7d-82ea-4827-8481-3f3a4cb84cb0'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210745, tzinfo=datetime.timezone.utc), UUID('8711ca27-0c25-4640-a4fe-9b646ef6868f'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('7fa336a5-73d0-4178-acb9-0bb121d20ee6'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210749, tzinfo=datetime.timezone.utc), UUID('81c8da8f-a445-4e48-ad04-4f7a8a78b335'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('0c4f8f6d-e6cf-4a29-ad43-207c155f488d'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210753, tzinfo=datetime.timezone.utc), UUID('29211326-5bbd-4ddf-9d41-9b15eedbfea0'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('0e2f3c2d-d4a1-4745-a719-031eb1ed60e0'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210757, tzinfo=datetime.timezone.utc), UUID('e8bb7283-d131-4572-9da6-f53d1ca2d62e'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('d250244e-2e60-4c02-9273-cd02c6e43591'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210761, tzinfo=datetime.timezone.utc), UUID('7baa594b-6d22-4b62-bd6c-957055a001e2'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('e66832ee-2e4f-4121-985a-918b10a8a79d'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210766, tzinfo=datetime.timezone.utc), UUID('bb2b1000-4799-4526-aee9-5dfcea201ce3'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('f4a4bd93-6634-4da1-865b-0aa280b866b9'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210770, tzinfo=datetime.timezone.utc), UUID('ca8b46a6-c56f-4d32-9bec-f4dc54568bc7'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('94733e0e-2824-45a1-80ca-ea6b00c5251b'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210774, tzinfo=datetime.timezone.utc), UUID('4eecaca1-66f3-4122-908b-d092c5716f17'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('7cc9bc59-9cc2-4291-a9bc-3ca8437812c6'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210777, tzinfo=datetime.timezone.utc), UUID('d771d2ba-55ef-4b7a-99d3-820d8ca6f14b'), UUID('d3ee0b52-6bf6-427c-b247-efc7a74b00e8'), UUID('7818ebd6-9191-4cf1-84b2-e81492795286'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 2, 12, 210781, tzinfo=datetime.timezone.utc))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2026-02-16T15:03:10.384022+00:00", "level": "INFO", "logger": "alekfi.brain.brain_pipeline", "msg": "[pipeline:S4] direction balance warning: 85% LONG"}
{"ts": "2026-02-16T15:04:20.463434+00:00", "level": "WARNING", "logger": "alekfi.brain.brain_pipeline", "msg": "[pipeline:S5] traceability insert FAILED for HLAG.DE", "exception": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 550, in _prepare_and_execute\n    self._rows = deque(await prepared_stmt.fetch(*parameters))\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 177, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 268, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 257, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 205, in bind_execute\nasyncpg.exceptions.ForeignKeyViolationError: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(c62e93f1-fd9e-4db4-a15e-eaa3ffe39802) is not present in table \"raw_posts\".\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2125, in _exec_insertmany_context\n    dialect.do_execute(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 952, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 585, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 563, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 513, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 797, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.ForeignKeyViolationError'>: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(c62e93f1-fd9e-4db4-a15e-eaa3ffe39802) is not present in table \"raw_posts\".\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/alekfi/brain/brain_pipeline.py\", line 1642, in _stage5_risk_adjust\n    async with get_session() as trace_session:\n               ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/contextlib.py\", line 217, in __aexit__\n    await anext(self.gen)\n  File \"/app/alekfi/db/database.py\", line 64, in get_session\n    await session.commit()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py\", line 1000, in commit\n    await greenlet_spawn(self.sync_session.commit)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2030, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 1311, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 1286, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4331, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4466, in _flush\n    with util.safe_reraise():\n         ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4427, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py\", line 1143, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1419, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 527, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2133, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2363, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2125, in _exec_insertmany_context\n    dialect.do_execute(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 952, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 585, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 563, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 513, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 797, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.ForeignKeyViolationError'>: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(c62e93f1-fd9e-4db4-a15e-eaa3ffe39802) is not present in table \"raw_posts\".\n[SQL: INSERT INTO signal_source_items (id, signal_id, raw_post_id, contribution_weight, platform, created_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::VARCHAR, $6::TIMESTAMP WITH TIME ZONE), ($7::UUID, $8::UUID, $9::UUID, $10::FLOAT, $11::VARCH ... 854 characters truncated ... ME ZONE), ($67::UUID, $68::UUID, $69::UUID, $70::FLOAT, $71::VARCHAR, $72::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID('5bf825ce-7316-45ab-a3cc-a37c607bbc39'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('c62e93f1-fd9e-4db4-a15e-eaa3ffe39802'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 460985, tzinfo=datetime.timezone.utc), UUID('66f22644-677d-43db-b10a-55472c1321d1'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('66cee00c-a6cc-4ba8-b6cf-02d3d00fa417'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 460991, tzinfo=datetime.timezone.utc), UUID('8f8fd4d5-321a-4990-baba-949e2b0668dc'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('76892afb-896a-4e61-8bb4-eb546735e3a1'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 460994, tzinfo=datetime.timezone.utc), UUID('cd75c3e5-4d32-4af9-80cf-2d4aa383ef45'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('bbeff2fb-0a57-4160-82b8-18c531bc1a07'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 460997, tzinfo=datetime.timezone.utc), UUID('88661b14-edad-413e-b817-571de148bf49'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('c0a71a29-bf42-4f49-bde5-cbd3096b9935'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 460999, tzinfo=datetime.timezone.utc), UUID('a6e79752-0246-47ba-969f-13d7b029bdf6'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('4759b2a1-8d4c-4535-8f8b-0eea90017f53'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 461006, tzinfo=datetime.timezone.utc), UUID('09e03121-9dcc-4a87-8dd8-4c022a667f12'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('29dd224c-aaa5-4428-a993-899b6bb753e6'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 461009, tzinfo=datetime.timezone.utc), UUID('ecf71a71-83b8-486c-b1f3-f79b314b9904'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('0e2f3c2d-d4a1-4745-a719-031eb1ed60e0'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 461012, tzinfo=datetime.timezone.utc), UUID('1f2125be-f12f-48b0-bfe0-f2a6879b6ada'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('d250244e-2e60-4c02-9273-cd02c6e43591'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 461014, tzinfo=datetime.timezone.utc), UUID('87b72e27-310d-469e-9db5-7b7100769a63'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('dd8036a0-9d74-472e-929c-e7fee47806b2'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 461019, tzinfo=datetime.timezone.utc), UUID('19a18649-88d5-428e-b757-b10263532f15'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('55731a93-e418-4766-a490-cfb7856430f2'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 461024, tzinfo=datetime.timezone.utc), UUID('5fefd016-0177-4089-a842-c412556e40e2'), UUID('eb316929-b100-41c0-a764-5e4141be4704'), UUID('9554190b-7675-4af3-8e55-21ed0e913b7f'), 0.08333333333333333, 'unknown', datetime.datetime(2026, 2, 16, 15, 4, 20, 461054, tzinfo=datetime.timezone.utc))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2026-02-16T15:05:13.783693+00:00", "level": "INFO", "logger": "alekfi.brain.brain_pipeline", "msg": "[pipeline:S4] direction balance warning: 86% LONG"}
{"ts": "2026-02-16T15:05:50.876716+00:00", "level": "INFO", "logger": "alekfi.workers.signal_decay_worker", "msg": "[HEARTBEAT] signal_decay_worker cycle=2 done: processed=0 elapsed=50.4s total_processed=0 total_outcomes=0 total_errors=0"}
{"ts": "2026-02-16T15:07:16.940633+00:00", "level": "INFO", "logger": "alekfi.brain.brain_pipeline", "msg": "[pipeline:S4] direction balance warning: 86% LONG"}
{"ts": "2026-02-16T15:08:28.046323+00:00", "level": "WARNING", "logger": "alekfi.brain.brain_pipeline", "msg": "[pipeline:S5] traceability insert FAILED for ANTH", "exception": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 550, in _prepare_and_execute\n    self._rows = deque(await prepared_stmt.fetch(*parameters))\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 177, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 268, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py\", line 257, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 205, in bind_execute\nasyncpg.exceptions.ForeignKeyViolationError: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(d00c88a4-4050-4df6-b7fa-412e50331b19) is not present in table \"raw_posts\".\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2125, in _exec_insertmany_context\n    dialect.do_execute(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 952, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 585, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 563, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 513, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 797, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.ForeignKeyViolationError'>: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(d00c88a4-4050-4df6-b7fa-412e50331b19) is not present in table \"raw_posts\".\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/alekfi/brain/brain_pipeline.py\", line 1642, in _stage5_risk_adjust\n    async with get_session() as trace_session:\n               ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/contextlib.py\", line 217, in __aexit__\n    await anext(self.gen)\n  File \"/app/alekfi/db/database.py\", line 64, in get_session\n    await session.commit()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py\", line 1000, in commit\n    await greenlet_spawn(self.sync_session.commit)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 2030, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 1311, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py\", line 137, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 1286, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4331, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4466, in _flush\n    with util.safe_reraise():\n         ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py\", line 224, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py\", line 4427, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py\", line 1143, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1419, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py\", line 527, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2133, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2363, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py\", line 2125, in _exec_insertmany_context\n    dialect.do_execute(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py\", line 952, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 585, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 563, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 513, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 797, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.ForeignKeyViolationError'>: insert or update on table \"signal_source_items\" violates foreign key constraint \"signal_source_items_raw_post_id_fkey\"\nDETAIL:  Key (raw_post_id)=(d00c88a4-4050-4df6-b7fa-412e50331b19) is not present in table \"raw_posts\".\n[SQL: INSERT INTO signal_source_items (id, signal_id, raw_post_id, contribution_weight, platform, created_at) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::FLOAT, $5::VARCHAR, $6::TIMESTAMP WITH TIME ZONE), ($7::UUID, $8::UUID, $9::UUID, $10::FLOAT, $11::VARCH ... 946 characters truncated ... ME ZONE), ($73::UUID, $74::UUID, $75::UUID, $76::FLOAT, $77::VARCHAR, $78::TIMESTAMP WITH TIME ZONE)]\n[parameters: (UUID('9bca5522-745a-4501-bd51-69ab6795d724'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('d00c88a4-4050-4df6-b7fa-412e50331b19'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44095, tzinfo=datetime.timezone.utc), UUID('e1af7442-8c92-4418-bfe0-5f70ad76e7f5'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('85d43e92-6fd0-4f46-b2f5-39dbafa19d97'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44101, tzinfo=datetime.timezone.utc), UUID('86c6acd9-4554-4ebb-9228-61b94e71dbd2'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('f2b71d11-38b8-4f35-a12d-99b0536997a3'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44104, tzinfo=datetime.timezone.utc), UUID('346a9b13-0b2a-4a99-8d41-2f620d5727c8'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('badee11f-163d-49f5-bdbe-c013c63d4dd9'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44107, tzinfo=datetime.timezone.utc), UUID('7c70a3dd-6a81-4bff-9607-91a1202e5cca'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('87cf978d-f9a1-4c9f-95a4-e20f501662d2'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44111, tzinfo=datetime.timezone.utc), UUID('6e6b618d-f653-4080-bf85-5c9ea5e7e6bf'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('2b2bd869-1804-49e1-ae63-8b7f3dbdb0a9'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44282, tzinfo=datetime.timezone.utc), UUID('9c42300f-3389-4496-bf49-766da39e1cf9'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('c0a71a29-bf42-4f49-bde5-cbd3096b9935'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44286, tzinfo=datetime.timezone.utc), UUID('8feb081f-313e-4dbc-99e8-cfdd0a00edd7'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('2e98c106-a338-4515-beee-0c86b07e9e83'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44289, tzinfo=datetime.timezone.utc), UUID('375d703a-a3a7-4dc2-ad4f-8ccf5381335d'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('87920226-eb9e-4335-b3b9-06ca05005334'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44292, tzinfo=datetime.timezone.utc), UUID('e994356c-503a-4ea3-af16-13650c9bf8b9'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('66219cb1-489f-42d5-836b-e7607d903185'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44295, tzinfo=datetime.timezone.utc), UUID('68fd0879-bcfd-4921-925a-a02e4f30a1ad'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('f30fb00e-9d96-4e64-9a2d-68372e906a13'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44298, tzinfo=datetime.timezone.utc), UUID('a394d616-1f70-449a-af0e-739e860d7b1f'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('fd273e56-9cb2-4986-b3d2-aa8b77e9a986'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44300, tzinfo=datetime.timezone.utc), UUID('0623055c-c34c-4409-9d8f-d95d749053be'), UUID('306e5d2e-9373-4298-bac0-059de4f474b6'), UUID('0c94cc5d-8976-4a1a-b9e8-d70db0c6bc67'), 0.07692307692307693, 'unknown', datetime.datetime(2026, 2, 16, 15, 8, 28, 44303, tzinfo=datetime.timezone.utc))]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
